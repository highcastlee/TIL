
# 주차 요금 계산
  - [주차 요금 계산](https://programmers.co.kr/learn/courses/30/lessons/92341)

### solution
  - 문자열 분리
  - 입출차 시간차 누적 기록
  - 입차 후, 출차되지 않은 차량은 23:59 기준으로 계산
  - 차량 번호 순으로 정렬 후, 누적 시간에 따른 요금 계산

  ```javascript
  function solution(fees, records) {
    let [dfTime, dfFee, unitTime, unitFee] = fees;
    let lastTime = 23*60+59
    const result = {}
    const data = {}
    // 문자열 분리 후, 입출차 시간차 기록
    records.forEach(r=> {
        const arr = r.split(' ');
        const times = arr[0].split(':').map(Number)
        const rec = {
            time: times[0] * 60 + times[1],
            carNum: arr[1],
            status : arr[2]
        }
        if(rec.status === 'IN') data[rec.carNum] = rec.time
        else {
            const diff = rec.time - data[rec.carNum]
            result[rec.carNum] = result[rec.carNum] ? result[rec.carNum] + diff : diff
            delete data[rec.carNum]
        }
    })
    
    // 출차되지 않은 차량 번호 23:59분 기준으로 시간차 계산
    const dataKeys = Object.keys(data)
    if(dataKeys.length > 0){
        dataKeys.forEach(carNum=>{
            result[carNum] = result[carNum] 
                ? result[carNum] + (lastTime - data[carNum]) 
                : lastTime - data[carNum]
            delete data[carNum]
        })
    }
    
    // 시간차 누적 계산된 result 차량 번호 순으로 정렬 후, 요금 계산
    return Object.entries(result).sort((a,b)=>+a[0] - +b[0]).map(([_,time])=>{
        const diff = time-dfTime;
        return diff<0 
            ? dfFee
            : dfFee + (diff % unitTime === 0 
                        ? (diff / unitTime) * unitFee 
                        : Math.ceil(diff/unitTime) * unitFee)
    })
  }
  ```